# multi-oauth2-proxy configuration example
# Copy this file to config.yaml and customize for your environment

# Service information
service:
  name: "Multi OAuth2 Proxy"
  description: "Authentication proxy for multiple OAuth2 providers"
  # Optional: Icon URL for auth header (48px icon, appears to the left of title)
  # icon_url: "https://example.com/icon.svg"
  # Optional: Logo URL for auth header (larger logo image, appears above title)
  # logo_url: "https://example.com/logo.svg"
  # Optional: Logo width (default: "200px", examples: "100px", "150px", "300px")
  # logo_width: "200px"

# HTTP server configuration
# Note: host and port are now set via command-line flags (-host, -port)
# Default values: host=0.0.0.0, port=4180
server:
  # Authentication path prefix (default: "/_auth")
  # All authentication endpoints will use this prefix
  # auth_path_prefix: "/_auth"

  # Base URL for email links and redirects (optional)
  # Used for email authentication login links
  # If not set, defaults to http://host:port (e.g., http://localhost:4180)
  # Set this when running behind a reverse proxy or using a different external URL
  # base_url: "https://auth.example.com"

  # OAuth2 callback URL override (optional)
  # Used for OAuth2 provider callback redirects
  # If not set, defaults to http://host:port/_auth/oauth2/callback
  # Set this when the external callback URL differs from the internal URL
  # callback_url: "https://auth.example.com/_auth/oauth2/callback"

# Proxy configuration
proxy:
  # Main upstream backend (required)
  upstream: "http://localhost:8080"

  # Host-based routing (optional)
  # Route different hosts to different upstreams
  # hosts:
  #   "app1.example.com": "http://backend1:8080"
  #   "app2.example.com": "http://backend2:8080"

# Session configuration
session:
  cookie_name: "_oauth2_proxy"
  # Generate a random secret: openssl rand -base64 32
  cookie_secret: "CHANGE-THIS-TO-A-RANDOM-SECRET-AT-LEAST-32-CHARACTERS-LONG"
  cookie_expire: "168h"  # 7 days
  cookie_secure: false   # Set to true when using HTTPS
  cookie_httponly: true
  cookie_samesite: "lax"

# OAuth2 providers configuration
oauth2:
  providers:
    # Google OAuth2
    - name: "google"
      display_name: "Google"
      client_id: "YOUR-GOOGLE-CLIENT-ID"
      client_secret: "YOUR-GOOGLE-CLIENT-SECRET"
      enabled: true
      # Optional: Custom icon URL (if not set, uses default Google icon)
      # icon_url: "https://example.com/custom-google-icon.svg"

    # GitHub OAuth2
    - name: "github"
      display_name: "GitHub"
      client_id: "YOUR-GITHUB-CLIENT-ID"
      client_secret: "YOUR-GITHUB-CLIENT-SECRET"
      enabled: false
      # Optional: Custom icon URL (if not set, uses default GitHub icon)
      # icon_url: "https://example.com/custom-github-icon.svg"

    # Microsoft OAuth2 (Azure AD)
    - name: "microsoft"
      display_name: "Microsoft"
      client_id: "YOUR-MICROSOFT-CLIENT-ID"
      client_secret: "YOUR-MICROSOFT-CLIENT-SECRET"
      enabled: false
      # Optional: Custom icon URL (if not set, uses default Microsoft icon)
      # icon_url: "https://example.com/custom-microsoft-icon.svg"

    # Custom OIDC Provider Example
    # - name: "custom-oidc"
    #   type: "custom"
    #   display_name: "My OIDC Provider"
    #   client_id: "YOUR-CLIENT-ID"
    #   client_secret: "YOUR-CLIENT-SECRET"
    #   enabled: false
    #   # Custom icon URL is especially useful for custom OIDC providers
    #   icon_url: "https://your-provider.com/logo.svg"
    #   auth_url: "https://your-provider.com/oauth/authorize"
    #   token_url: "https://your-provider.com/oauth/token"
    #   userinfo_url: "https://your-provider.com/oauth/userinfo"
    #   # Optional: JWKS URL for token validation
    #   # jwks_url: "https://your-provider.com/.well-known/jwks.json"
    #   # Allow HTTP for local testing (default: false, use only for development)
    #   # insecure_skip_verify: true

# Email authentication configuration (Phase 2)
email_auth:
  enabled: true

  # Sender type: "smtp" or "sendgrid"
  sender_type: "smtp"

  # SMTP configuration (when sender_type: "smtp")
  smtp:
    host: "smtp.gmail.com"
    port: 587
    username: "your-email@gmail.com"
    password: "your-app-password"
    from: "noreply@example.com"
    from_name: "Multi OAuth2 Proxy"
    tls: false
    starttls: true

  # SendGrid configuration (when sender_type: "sendgrid")
  # sendgrid:
  #   api_key: "SG.xxxxxxxxxxxxxxxxxxxx"
  #   from: "noreply@example.com"
  #   from_name: "Multi OAuth2 Proxy"

  # Token expiration
  token:
    expire: "15m"  # 15 minutes

# Authorization configuration
authorization:
  # Allowed email addresses and domains
  # Entries starting with @ are domains, others are email addresses
  # Leave empty [] to allow all authenticated users (no whitelist)
  allowed:
    - "user@example.com"
    - "admin@company.com"
    - "@example.org"
    - "@company.com"

# Logging configuration
logging:
  level: "info"         # debug, info, warn, error
  module_level: "debug" # Log level for sub-modules
  color: true           # Enable colored output (auto-detects TTY)
